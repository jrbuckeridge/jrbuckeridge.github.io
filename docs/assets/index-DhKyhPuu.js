(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const h of s)if(h.type==="childList")for(const d of h.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function e(s){const h={};return s.integrity&&(h.integrity=s.integrity),s.referrerPolicy&&(h.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?h.credentials="include":s.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function i(s){if(s.ep)return;s.ep=!0;const h=e(s);fetch(s.href,h)}})();class r{constructor(t,e,i,s){this.x=t,this.y=e,this.width=i,this.height=s}scaled(t){return new r(this.x*t,this.y*t,this.width*t,this.height*t)}collidesWith(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}}class l{constructor(t,e,i){this.width=t,this.height=e,this.scale=i||1}}const k=5,Y=10;class y{constructor(t,e,i,s,h,d){this.player=t,this.id=e,this.numFrames=s,this.images=[];for(let f=1;f<=s;f++){const B=new Image,c=String(f).padStart(2,"0");B.src=i+c+".png",this.images.push(B)}this.size=h,this.size.scale=this.size.scale||1,this.resize(t.game.size),this.timeInState=0,this.hitBox=d}reset(){this.timeInState=0}getHitBox(){return this.hitBox}resize(t){this.size.scaledWidth=this.size.width*this.size.scale*this.player.game.ratio.yScale,this.size.scaledHeight=this.size.height*this.size.scale*this.player.game.ratio.yScale}}class S extends y{constructor(t){super(t,"idle","img/hero-girl/Golden_Kunoichi_Idle_",8,new l(200,300),new r(50,50,100,225))}handleInput(t){if(!t.released)switch(t.key){case"ArrowUp":this.player.tryJump();break;case"ArrowDown":this.player.tryCrouch();break;case"ArrowRight":this.player.tryRun();break;case" ":this.player.tryAttack();break}}update(t){this.timeInState+=t*.5,this.player.speedY=0,this.player.speedX>0?this.player.speedX-=k:this.player.x>this.player.initialXPosition&&(this.player.x-=5)}}class L extends y{constructor(t){super(t,"jump","img/hero-girl/Golden_Kunoichi_Jump_",14,new l(250,300),new r(50,50,150,150)),this.allowedTimeInState=2*233.31}handleInput(t){}update(t){this.timeInState+=t*.75,this.timeInState<this.allowedTimeInState/2?this.player.speedY=-30:this.timeInState>=this.allowedTimeInState/2&&this.timeInState<this.allowedTimeInState?this.player.speedY=30:(this.player.speedY=0,this.player.tryIdle())}}class P extends y{constructor(t){super(t,"run","img/hero-girl/Golden_Kunoichi_Run_",8,new l(250,300),new r(50,50,150,225))}handleInput(t){if(!t.released){switch(t.key){case"ArrowUp":this.player.tryJump();break;case" ":this.player.tryAttack();break}return}switch(t.key){case"ArrowRight":this.player.tryIdle();break}}update(t){this.timeInState+=t,this.player.speedY=0,this.player.speedX<Y&&(this.player.speedX+=k)}}class b extends y{constructor(t){super(t,"attack","img/hero-girl/Golden_Kunoichi_Attack_",17,new l(500,350),new r(200,50,250,250)),this.sounds=[],["sounds/swish-9.wav","sounds/swish-10.wav"].forEach(i=>{const s=new Audio;s.src=i,this.sounds.push(s)})}reset(){super.reset(),this.sounds[0].play()}handleInput(t){}update(t){this.timeInState+=t,this.player.speedX=0,this.player.speedY=0,this.timeInState>=566&&this.player.tryIdle()}}class C extends y{constructor(t){super(t,"hurt","img/hero-girl/Golden_Kunoichi_Hurt_",3,new l(200,300),new r(0,0,0,0)),this.sounds=[],["sounds/blub_hurt.wav"].forEach(i=>{const s=new Audio;s.src=i,this.sounds.push(s)})}reset(){super.reset(),this.sounds[0].play()}handleInput(t){}update(t){this.timeInState+=t,this.player.speedX=0,this.player.speedY=0,this.timeInState>=500&&this.player.tryIdle()}}class H extends y{constructor(t){super(t,"faint","img/hero-girl/Golden_Kunoichi_Faint_",14,new l(250,300),new r(0,0,0,0)),this.sounds=[],["sounds/blub_hurt.wav"].forEach(i=>{const s=new Audio;s.src=i,this.sounds.push(s)})}reset(){super.reset(),this.sounds[0].play()}handleInput(t){}update(t){this.timeInState+=t*.25,this.player.speedX=0,this.player.speedY=0,this.timeInState>=450&&(this.player.gameOver=!0)}}class N extends y{constructor(t){super(t,"crouch","img/hero-girl/Golden_Kunoichi_Crouch_",2,new l(200,300),new r(50,125,100,100))}handleInput(t){if(t.released)switch(t.key){case"ArrowDown":this.player.tryIdle();break}}update(t){this.timeInState+=t*.1,this.player.speedX=0,this.player.speedY=0}}const v=100;class D{constructor(t){this.game=t,this.states={},this.states.idle=new S(this),this.states.jump=new L(this),this.states.run=new P(this),this.states.attack=new b(this),this.states.crouch=new N(this),this.states.faint=new H(this),this.states.hurt=new C(this),this.state=this.states.idle,this.initialXPosition=this.game.size.width*.25-this.state.size.width/2,this.x=this.initialXPosition,this.y=this.game.size.height-this.state.size.height*this.game.ratio.yScale,this.speedX=0,this.speedY=0,this.life=v,this.gameOver=!1}resize(t){for(let e in this.states)this.states[e].resize(t);this.groundHero()}draw(t,e){const i=Math.floor(this.state.timeInState/33.33)%this.state.images.length;t.drawImage(this.state.images[i],0,0,this.state.size.width,this.state.size.height,this.x,this.y,this.state.size.scaledWidth,this.state.size.scaledHeight)}update(t){this.gameOver||(this.state.update(t),this.x+=this.speedX,this.y+=this.speedY,this.y<this.game.size.height*.05?this.y=this.game.size.height*.05:this.y>this.game.size.height-this.state.size.scaledHeight&&(this.y=this.game.size.height-this.state.size.scaledHeight))}handleInput(t){this.state.handleInput(t)}handleControlsInput(t){}tryJump(){this.setState("jump")}tryIdle(){this.setState("idle")}tryRun(){this.setState("run")}tryAttack(){this.setState("attack")}tryGetHit(){this.state.id!=="hurt"&&(this.life-=15,this.life<0&&(this.life=0),this.isDefeated()?this.setState("faint"):this.setState("hurt"))}tryCrouch(){this.setState("crouch")}isAttacking(){return this.state===this.states.attack}setState(t){this.state=this.states[t],this.state.reset(),this.groundHero()}groundHero(){this.y=this.game.size.height-this.state.size.scaledHeight}getHitBox(){let t=this.state.getHitBox().scaled(this.game.ratio.yScale);return new r(this.x+t.x,this.y+this.speedY+t.y,t.width,t.height)}increaseLife(t){this.life+=t,this.life>v&&(this.life=v)}isDefeated(){return this.life<=0}}class m{constructor(t,e,i){this.image=new Image,this.image.src=t,this.x=0,this.xScale=e,this.width=2048,this.height=1536,this.gameSize=i,this.aspectRatio=this.width/this.height}resize(t,e){this.gameSize=t}computedWidth(){return this.gameSize.height*this.aspectRatio}update(t){this.x-=t*this.xScale,(this.x>=this.width||this.x<=-this.width)&&(this.x=this.x%this.width)}draw(t,e){let i=Math.floor((this.width-this.x)*this.aspectRatio);t.drawImage(this.image,this.x,0,this.width-this.x,this.height,0,0,i,this.gameSize.height),i<this.gameSize.width&&t.drawImage(this.image,0,0,this.width,this.height,i,0,i+Math.floor(this.width*this.aspectRatio),this.gameSize.height)}}class z{constructor(t,e){this.gameWidth=t.width,this.gameHeight=t.height,this.oscillatingFactor=1+Math.random(),this.oscillatingScalePercent=Math.random()*.05,this.yOffsetPercent=Math.random()<.5?75:50,this.states={},this.width=1261,this.height=747,this.scale=.1,this.states.flying=new R(this,"img/villains/"+e+"/skeleton-flying_",10),this.states.defeated=new U(this,"img/villains/"+e+"/skeleton-defeated_",20),this.state=this.states.flying,this.x=this.gameWidth*1.1,this.y=this.gameHeight*.65,this.disabled=!1,this.defeated=!1,this.scoreValue=80+Math.floor(Math.random()*20)}setPosition(t,e){this.x=t,this.y=e}resize(t,e){this.gameWidth=t.width,this.gameHeight=t.height}draw(t,e){if(this.disabled)return;const i=Math.floor(this.state.timeInState/33.33)%this.state.images.length;t.drawImage(this.state.images[i],0,0,this.width,this.height,this.x,this.y,this.width*this.scale,this.height*this.scale)}update(t){this.disabled||this.state.update(t)}tryDefeated(){this.state=this.states.defeated,this.state.reset(),this.defeated=!0}getHitBox(){return new r(this.x+30,this.y,(this.width-500)*this.scale,(this.height-250)*this.scale)}}let G=class{constructor(t,e,i){this.villain=t,this.images=[];for(let s=1;s<=i;s++){const h=new Image;h.src=e+s+".png",this.images.push(h)}this.timeInState=0}reset(){this.timeInState=0}update(t){this.timeInState+=t}};class R extends G{constructor(t,e,i){super(t,e,i)}update(t){super.update(t),this.villain.x-=t*.15;const e=this.villain.oscillatingScalePercent*this.villain.gameHeight/100;this.villain.y=e*Math.sin(this.villain.oscillatingFactor*this.timeInState/100)+this.villain.yOffsetPercent*this.villain.gameHeight/100}}class U extends G{constructor(t,e,i){super(t,e,i)}update(t){super.update(t),this.timeInState>20*33.33&&(this.villain.disabled=!0)}}class E{constructor(t,e,i,s){this.gameWidth=t,this.gameHeight=e,this.states={},this.size=i,this.states.moving=new F(this,s),this.state=this.states.moving,this.x=this.gameWidth*1.1,this.yOffsetPercent=55+(Math.random()-.5)*30,this.y=this.gameHeight*this.yOffsetPercent/100,this.disabled=!1,this.scoreValue=0,this.lifeValue=0}setPosition(t,e){this.x=t,this.y=e}resize(t,e){this.gameWidth=t.width,this.gameHeight=t.height,this.y=this.gameHeight*this.yOffsetPercent/100}draw(t,e){if(this.disabled)return;const i=Math.floor(this.state.timeInState/33.33)%this.state.images.length;t.drawImage(this.state.images[i],0,0,this.size.width,this.size.height,this.x,this.y,this.size.width*this.size.scale,this.size.height*this.size.scale)}update(t){this.disabled||this.state.update(t)}tryCapture(){this.disabled=!0}getHitBox(){return new r(this.x,this.y,this.size.width*this.size.scale,this.size.height*this.size.scale)}}class x extends E{constructor(t){super(t.width,t.height,new l(266,268,.2),{imagePrefix:"img/coins/gold-coins/frame-",numStates:8}),this.scoreValue=20+Math.floor(Math.random()*20),this.lifeValue=15}}class M extends E{constructor(t){super(t.width,t.height,new l(299,297,.15),{imagePrefix:"img/health/red-health/frame-",numStates:6}),this.scoreValue=0,this.lifeValue=15}}class O{constructor(t,e){this.powerUp=t,this.images=[];for(let i=1;i<=e.numStates;i++){const s=new Image;s.src=e.imagePrefix+i+".png",this.images.push(s)}this.timeInState=0}reset(){this.timeInState=0}update(t){this.timeInState+=t}}class F extends O{constructor(t,e){super(t,e)}update(t){super.update(t),this.powerUp.x-=t*.2}}const Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAA9CAYAAAAH6Y9PAAAC8klEQVR42u3c2Y0aQRAGYDLZECxeuO/7vm8JgYREOg5hQnAIG4pD2BDK/SOPVa7FXmAuqoeS/pcV9HR9c8D0oE0kTM1ms7flcvl9vV6/I5vNhp452+32kIiqer0esD4MFGnKfD6PBs1g/VitVqQxkaBpxYoMzRxhxFMulymTyTxlarUayfki0+n0EBnYs2I9DdpisSCeZwdz0eS8kVDQNIJFimYumsSjBcxFk/NHAkXTDBYJmvmWTzzawJBqtUqyDyQQNBvAQkUzAxKPVjAXTfbzO4cXWFRok8mEeLSDuWiyL8QXNBvBAkUbj8fEYwsYUqlUSPaH9Pv9wwssLLTRaEQ8toG5aLJP5CG0OID5ijYcDonHVjAEa32yX6TT6dyONhgMiMdmMBdN9ozcjBY3MM9o5hwmnjiAuWiyd+RLtLiCPYzW6/WIx8sEcrnc5ZnhbrdTg1YqlUgaIK1W6xAoGLD2+z2dz+dLNB1pd6F1u13i8QNLG5iLJi2QT2hewa5haQS7Gc1c4IjHDyytYC6aNEH+oHkBw8X9GpZmMPc26hpas9ksJ9rtNvHcM/DxeLQODGeNOZpIupi/OZcjzAsY9sTpdLIG7EssFF7A88jhew1NI5Y55Uh61Ot1569PSa9g/0KzEguFF/J4uVByNE1YjUaDpMNVLD/BOBpiJRYKb+CJy403sAwMyf5rtZrz39WKOII9jIXCG3nigIVf/Mi+zeXEuWnFNU5gnrFQGIDHVqxsNnt5Gi77vQsLhUF4bMXCJ7js1dxoO3c/l7QdzFcsFAbjsQ0L6/ayx4exbAYLBAuFQXlswcJCoOzNM5aNYIFioTA4j3asYrFIsqd8Pu8Plk1goWChsBEerWCFQoFkL75j2QIWGhYKG+PRhmVgSPZg7hmDwdIOFjoWChvl0bTyIOceOJZWsMiwUNg4j4avD3LOoWGhzCR+XpmApoSHhUqlUg72msZg7qH/3wqzh97Mxj9eWHdUMpn8lk6n37V8QkaJ9QtuIYqtPQHeHgAAAC10RVh0U29mdHdhcmUAYnkuYmxvb2RkeS5jcnlwdG8uaW1hZ2UuUE5HMjRFbmNvZGVyqAZ/7gAAAABJRU5ErkJggg==",T="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAA9CAYAAADlNZQ2AAACy0lEQVR42u3cyY3iQBTGcTKZEEZc2DFgdrPvEhLyAYl0JgSHMCF0KBNCh1BTX6st1bwx3Zjy9oqy9L/0AdX7sbjxQqmU07bb7fzT6SSK2uFwePvsl+d5P0oW6mG491zAAHU8HgW3JNhvCxWjzKA2m40vnx1Bc11X1Gq1wtXpdIR8cv9Zq4X6IrreTKD2+72gFR0K0TVbqCJgAQrveRoXKETXbqHyxALUdrsVtF6vxwoK0RksVB5YgJIJGlcoRGexUFliAWq9XgsadyhEZ9KCms1m/mq1ErRut8seCtG5LFTaWIBaLpeCZhIUovNZqLSwJpOJv1gsBA2HM0yDQnROC5U0FqDm87mgmQyF6LwWKiksQMkPdEF7BShE57ZQulij0cj3PE/QHMdhMeT5fP4439doNLQeh85vHBS63W4fXS4XLbAvsQA1nU4FjROUiqULRh2Mg6JYOmCRWICSH+iCxhEqCutZMOpRGg6HnSgozt/1orBCMC2sz1dWMB6PhZr8m/bepGhY1+s11uNQE/Uzyxiwe1Bx3y13sbD1+/0AQGrybcoOLAkoRC3++z/LBLAkoB7CCsEApDYYDNiAJQGFqMHd74acwYCkCxULC5vrugGA1CQi271k3Ojs3x7PemWw2FjY5Ms5AJAarogxHYzO/PAx+FcEexorBAOQGk7T1+t1I7HorLHPG74SmDYWNsdxAgCpYTdtGhid8elrHV4BLDGsEAxAajihYQoYnU37+iyAAUgNBw1NAKNzJXLln6lgqWBhazabAYDU2u02azA6T6JXK5sGlipWCAYgtVarxRKLzpHKHRamgGWChU1+ZwwApCYRWWHR9ad6Vxh3sEyxQjAAqXE5UkHXncmdrFzBcsEKwQCkVvR/Keh6M737PgqMSxLvT+a/61CpVAK8oriFdefyiyEMwd7lqyu/n1gBGIc9YrVafSuXyz+x5r+FWyOQMmYqoQAAAC10RVh0U29mdHdhcmUAYnkuYmxvb2RkeS5jcnlwdG8uaW1hZ2UuUE5HMjRFbmNvZGVyqAZ/7gAAAABJRU5ErkJggg==",V="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAABMCAYAAADeHL+NAAACkUlEQVR42u3beWrjUAwGcN9kbhGy76uz7yEQ5o9ArjNH8BF6hB6pR9C8r+BBI9dt2sTPtp4FHzWxI+mHS9N08TxTm83m136//3M8Hl+R0+lEWhKa4IMTXs/3fYDfzAnSHjjh9czBiwtgBn/xDocDuZYIutVqUblcVhN4drvd/2hzu4lHEziMNBZoZ9D4fOfRiJZGN9Hb7ZZ4NKKl0U20+X6UeDSipbFAO4Ner9fEY2OJarX67w0AjpOeJ43W0UBeLhe63W7vwXHS8Ah6tVoRj02wLbg0WkPHgW3AI+jlckk8aYCThkujFfT5fP4SzOEq0Nfr9W408uy7HUEvFgvi0fg6LY1uoufzOfFoREujm+jZbEY8GtHSWKCdQU+nU+LRiJZGN9G+7xOPRrQ0Fmhn0JPJhHg0oqXRTfR4PCYejWhpdBM9Go2IRyNaGgu0M+jhcEg8GtHS6CZ6MBgQj43fLdkMPNIYQff7fTVwOOCJoLvdboATPL1eL/dw7A+HtMH7/kex2uBfgsPSAr8bHFa73Q7wBB5zcW7g2BP7SgNc3meVV/iPwRyOBjydTocqlUomwdgL+8md7wbnDf40cFjNZjNAQx7TLDNw7IF95I7Y23uksgpPDJxVeOJgDscgHvyrgG045mGu3OXp4KzArYM5HIN5zGOJw9Efcz6YnSw4LXjq4LBqtVqARXgajcbT4eiHvnIW5ntpVNLwzIGThmcWzOFYkKderz+ExvNlz8yAk4DnAhyWeXsXYGEes+y3wLhe9kBfL8v1CDyX4EfguQZzOCA8cT99weMfXJsv8HfgqsAcDhhP+BqOj/Jc7sGfwWOiAxxWqVQKcGfjgvOexoqDqwXHwdWDORxfyJwBM/jvtGb/BevrqsgoaTNeAAAALXRFWHRTb2Z0d2FyZQBieS5ibG9vZGR5LmNyeXB0by5pbWFnZS5QTkcyNEVuY29kZXKoBn/uAAAAAElFTkSuQmCC",W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAABLCAYAAADDGY81AAACeklEQVR42u3aaWrjQBCGYd0kRxj8x/u+7/v+RwaDr5Wj5Cg5whyhRl9AQ02lM5FxWku1DS+OhSzVQxKB3fK8hB7r9frFc+lxOp384/FIeHYCvNls/MPhQGF47RRYPRyw/X5PX6UO/h1YHXy1Wvm73Y5k4/GYTNuxv0pwu92mYrH48awKjsG32y3JQnAYXpv2yxw8KlgN/F5w5uEYMLgCk+w7MIeb3p9a+KPgzMExUPABgmStVusucBjeZzpeauA/DU49HAMEkexRMIebjp8Y3DY4dfC4wKmB40TL5ZJktsAcbjqvdXhS4MTgk8nEXywWJGs2m7GAw3A+0xyYTyU4NjgONJ/PSZYUmMNNcz0MTyvYGnw4HPqz2YxkjUYjFeAwzGOaE/OrBP8YPGvgh+HYYTqdkiztYA43zf8lPOvgu+HYEFzxSJY1MIebPH/h2sCR4PjSXVav1zMNDoPD5PO0gv8H/4TWBA77hB6NRsTTiJZGN9HB1Yx4GtHS6CZ6MBgQTyNaGt1E9/t94mlES+MT7Qy61+sRTyNaGt1Ed7td4mlES6Ob6E6nQzyNaGl8op1B424enka0NLqJxkI3TyNaGmNBn89nut1ukcK+5XLZLhrLnTwb6MvlEhl9vV6tLOnyYkHjuMBEAduYIRF0FLgtsBGN5Q+e7TsHTHCb4HCJhxcr2gS3DTaisezBi+teEWDjAIdLO7xE0EmsZ/2DrtVqxNOIlkY30dVqlXga0dL4RDuDrlQqxNOIlkY30fgYx9OIlkY30aVSiXga0dLoFQqFd7lRc/B6+Xz+1SU0vPiffgl++K3xz1oGJ7wf94fmcrlfwa/9TTMYPjjh/QMZsQJ5+4KrsQAAAC10RVh0U29mdHdhcmUAYnkuYmxvb2RkeS5jcnlwdG8uaW1hZ2UuUE5HMjRFbmNvZGVyqAZ/7gAAAABJRU5ErkJggg==",X="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAAA9CAYAAAAH6Y9PAAABm0lEQVR42u3cr07FMBQG8D0CEomeWvYn2yOQKSQSN3slEscj8CRTU1Mzk0uQSCQSyb1N7iUBhjjrOd32nfMln22bX5qmNY2iU5IkuUrT9Laqqodzn7bc03qTaK04rKIoHreOtBm0PM/v94a1KtpesVZD2ztYcDQEsKBoKGDB0JDAgqChgYmjIYKJoqGCiaEhg4mgoYOxo2kAY0XTAsaGpgmMBU0bmDeaRjAvNK1gi9E0gy1C0w5GRjMwIpphEdEMiohmSEQ0zonqun5u2/a167o3WDROrL7v36dp+nKF3WkSWChgs2gSWEhgf9AksNDAfqD5DOIO9zksRLBzb7zAhmH40AKWZdmd9w5rmuZlHMdPdLBvLI5D/z80SCyua8UcGiQW58X1NxokFvfT6ILmCollj28iloERsQyMiGVgRCwDI2JpByNjaQZbhKUVbDGWRjAvLG1g3liawFiwtICxYWkAY8VCB2PHQgYTwUIFE8NCBBPFQgMTx0ICC4KFAhYMy6Usy4NhEeImNCwFP6OsgnVJHMfXe/hzZwtYR1bZIqNiMGMqAAAALXRFWHRTb2Z0d2FyZQBieS5ibG9vZGR5LmNyeXB0by5pbWFnZS5QTkcyNEVuY29kZXKoBn/uAAAAAElFTkSuQmCC",j="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAA9CAYAAADlNZQ2AAABs0lEQVR42u3crW7DMBAH8DxC4WBx0JQPJY9QBQ0OloUWDpbtEfYkQUHhgZEGB/cIg1sMIk1Tu9rxnVP/7yJdsPWTYzv2nZNko+dxfuq6Pt9xHE1kWXaYm7pLFMouyrJ82QQsNqgliqJ4ViiHUKh7w0KACoKFAsWOhQTFioUGxYaFCMWChQpFjoUMRYqFDkWGJQGKBEsKlDeWJCgvLGlQq7EkQq3CkgrljCUZyglLOpQ1lkJZYimUJZZCWWIplCVW7FB93390XffeNM0rKxZCj5qm6dvEMAyflGCQn96CRQ0GOUb9xqIEgxzM/2JRgSXza482a13CWsC8e1ae508SsMZx/CIZs5DArkG1bftGNhuigHFAXVxnIYBxQF1dwccOxgH1779hzGAGiRrq5q4D2izJvp+lYI47pQrmuAevYI6nO9LBnM8NJYOtOpGWCrY610EimFcWjTQw7/wsSWAkmX9SwMhySiWAkWYro4OR58Ejg7FUWKCCsdXuIIKxVoWhgbHXGyKBBalkRQELViONABa0+j5msKqqTsHvdYgVzLR7kxtDYgPb7MaQCMGOaZo+mDb/AHmR3D3GImhiAAAALXRFWHRTb2Z0d2FyZQBieS5ibG9vZGR5LmNyeXB0by5pbWFnZS5QTkcyNEVuY29kZXKoBn/uAAAAAElFTkSuQmCC",J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAABMCAYAAADeHL+NAAABUklEQVR42u3aO2rEMBDGcR1hj2L8AB8huEqZMsdImS4ncuXKvUtDypR7hJSJx0Rh2Qd+SZrR6Bv4w3Tihwo1MmaaLMtOeZ4/1XX9+te7omYT+chpLLiqqjdl0LuRc4aXZfmSAthGXpMS2AY00EADDTTQQAMNNNCpoJum+Wjb9pOiXT2akH3fn8dx/KFoDw03nGAuuOEGc8CNBHBoeBB013VfS+BLuAr0MAzfa9GU79vGOw000EADDTTQQAMNNNBAAw000EADDTTQQAOtF10UxXNKYPLOn2JTgf+D7WiH34C1wx+CtcIXwdrgq8Fa4JvBscN3g2OFHwbHBncGjgXuHCwd7g0sFe4dLA0eDCwFHhzMDWcDc8HZwaHhYsCh4OLAvuFiwb7g4sGu4dGAXcGjAx+FRwveC48evBWuBrwWrg68BFcLfgRXD76GJwO2k03DdfYvPZgkiTovMxEAAAAtdEVYdFNvZnR3YXJlAGJ5LmJsb29kZHkuY3J5cHRvLmltYWdlLlBORzI0RW5jb2RlcqgGf+4AAAAASUVORK5CYII=",Z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAABLCAYAAADDGY81AAABVUlEQVR42u3cMQ6CQBAFUI5g6RmoSAiBM1B5BDtaS0s7j+BhOAANJb1HsLRUxwQTMYQF2Z2d2T/JZJPNNC+bnekmipgiSZJNFFK8wElRFCc6gwL3qR4+BKuHj4HVwqfA6uCmYDXwuWDx8KVgsfB/weLga4HFwNcGew+3BfYWbhvsHdwV2Bu4azA7nAvMBucGO4f7AnYG9w1sHe4r2Brcd/DqcCng1eDSwH/DpYIXw6WDZ8O1gI3h2sCTcK3gUbh28A88FPAXPCRwn0ADDTTQQAMNNNBAAw000EADDTTQQAMNNNB2sq7ra9d1D5Ok2rIsz+LRTdPcTNFt295VvHRVVRfCmICpVs2fnoK7AjtvZGNwl2CW7j2EuwazjawezgHGnAYaaKCBBhpooIEGmgud5/khJDB5ozRNdyGhyftespJl2TEEMDk/S2XiON6+LvfK0XtykvcJJj7awSJQWl4AAAAtdEVYdFNvZnR3YXJlAGJ5LmJsb29kZHkuY3J5cHRvLmltYWdlLlBORzI0RW5jb2RlcqgGf+4AAAAASUVORK5CYII=",K="data:image/png;base64,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",q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAD30lEQVR42u1dK4wbQQwNLDxYGFhFirTKR1m4sCRSYOEqqPBAQGFJVFhy0sGCgMLAKqgoKiysghpWWBQVbvedJqdckv1l7bF3diyNjtztZl5sP4/t8XU6ghIEwV0Yht10RYPB4G36My6z8LuTySTE3+IZnbYINouNj0ajd+nP+xSAjxQLzzLPDLvd7iunQMOGUuCC4XD4ngqwEivGOxuvbTC18Xj8wSJwL5Z5d9QoMzd+LZYCLWvhy1QNJExVWuPKaKRKP9nr9V5TkgL3wmfFZ1YBXkoOs6YAdwXIUNRkLTMry8IerJs01N8F8E5BtGbSeJFmoqhDMOwgIgxwEbxTENlCHVd8nohPbAt4bCDioN4W8I4Le259nEegibO6pBG0Fbzjujmr4zrjsjOzxoyK4IorgWfS5R64W87NoG9vutdNuVRoY4o7HrSMpGyZbLIHK5+V7/KII/IgFa7IGd+3WCwesVT4wiYEzdPp9NNqtVr/TOVwOPxLjGy32x/iwbXWZAE0bL1ef/uTSpIhu93ul+1kg1rygJY9PDx8hZb9TSUpEGgi/kaUTKQD5/l8/hlatt/vfycVBODZ9oFXA2uJdBW0DL6rjJZlCfyhinSXrZdiw/BXCYFsNpvv0u7muUhkA7g6mnYu8I8a/PVTEYrT/8G5V/VrRQI2liCNTD/IdfaFcz+N1ShEinFzz8YceT8O8CBwAzBfuAQlQMbkAGJjHOBlmTOYHIwuBGhMzsDYUCIkABTsvFwuv1hjYuoH2tK+MgICA6CcwTYpgPjmE6WCLxYxKE48lObeGgDPNdMDWJPNVQKIpIBm4I5mTOkTyUmE8sjWBCLpUDeH48NKAmYzlAF2jQ6kFQTTMUsuEJvhJAAtx7mnnCBXKRMb5NA2dSVOzmoc/BC1OWvJBT5X57gTqjAz6vMxThNqEqq2UvqIEc/ruXUEflZFSl+iqATThlbm1Xo1V+QuikqSZU1o5q3FJjCyFBO/KGtqKqxXLXdKMfNFl5bG1o5jwb1IO22XOC9aO5rQ1pvX8mG7N+Zquy9atprW2gbtxIKm2nx3Zqtvmy/VkFy+8S2+NVt8vRYSXP3yN5QIbiz5ZvMKzeU5t5XuPWgnmedbZiN48M6yLjdcOPSmXNV0/a3NGrc0/bwEprkJrs6KsTpDpi0gsg7gcW3kk8gIKFd9otUhZK6BKDLBzeQPGx/ioDgkOtFS+9jPguSAjkm/fgQo4RBaP/aTQBs1DitDMlSd1hWcobsagGwccBl1lsgm0Rh/HDk3V9/M1J9xEA6eCR/c7/ffdNog0EwAevw3GFVANb8bm/HugeSI9//tXqyjtsR4agAAAC10RVh0U29mdHdhcmUAYnkuYmxvb2RkeS5jcnlwdG8uaW1hZ2UuUE5HMjRFbmNvZGVyqAZ/7gAAAABJRU5ErkJggg==",a=new l(61,75),o=new l(75,61),g=new l(80,80);function A(n){const t=new Image;return t.src=n,t}const _=A(V),$=A(J),tt=A(W),et=A(Z),it=A(Q),st=A(X),ht=A(T),nt=A(j),at=A(K),ot=A(q);class rt{constructor(){this.horizontal=0,this.vertical=0,this.attack=!0}}class u{constructor(t,e){this.key=t,this.released=e}}class dt{constructor(t,e,i){this.controls=new rt,this.directionsPosition=e,this.actionsPosition=i,this.directionPointerId=void 0,this.attackPointerId=void 0,this.directionHitBoxes=void 0,this.attackHitBox=void 0,this.initControlHitBoxes(),this.keyDownEventListener=s=>{switch(s.key){case"ArrowUp":this.controls.vertical=-1;break;case"ArrowDown":this.controls.vertical=1;break;case"ArrowLeft":this.controls.horizontal=-1;break;case"ArrowRight":this.controls.horizontal=1;break;case" ":this.controls.attack=!0;break}t.handleInput({key:s.key,released:!1})},this.keyUpEventListener=s=>{switch(s.key){case"ArrowUp":this.controls.vertical<0&&(this.controls.vertical=0);break;case"ArrowDown":this.controls.vertical>0&&(this.controls.vertical=0);break;case"ArrowLeft":this.controls.horizontal<0&&(this.controls.horizontal=0);break;case"ArrowRight":this.controls.horizontal>0&&(this.controls.horizontal=0);break;case" ":this.controls.attack=!1;break}t.handleInput({key:s.key,released:!0})},this.touchStartEventListener=s=>{s.preventDefault();for(const h of s.changedTouches){const d=new r(h.pageX-h.radiusX/2,h.pageY-h.radiusY/2,h.radiusX*2,h.radiusY*2);this.directionPointerId===void 0&&(this.directionHitBoxes.up.collidesWith(d)?(this.directionPointerId=h.identifier,this.controls.vertical=-1,t.handleInput(new u("ArrowUp",!1))):this.directionHitBoxes.down.collidesWith(d)&&(this.directionPointerId=h.identifier,this.controls.vertical=1,t.handleInput(new u("ArrowDown",!1))),this.directionHitBoxes.left.collidesWith(d)?(this.directionPointerId=h.identifier,this.controls.horizontal=-1,t.handleInput(new u("ArrowLeft",!1))):this.directionHitBoxes.right.collidesWith(d)&&(this.directionPointerId=h.identifier,this.controls.horizontal=1,t.handleInput(new u("ArrowRight",!1)))),this.attackPointerId===void 0&&this.attackHitBox.collidesWith(d)&&(this.attackPointerId=h.identifier,this.controls.attack=!0,t.handleInput(new u(" ",!1)))}t.handleControlsInput(this.controls)},this.touchEndEventListener=s=>{s.preventDefault();for(const h of s.changedTouches)this.directionPointerId!==void 0&&this.directionPointerId===h.identifier&&(this.directionPointerId=void 0,this.controls.horizontal=0,this.controls.vertical=0,t.handleInput(new u("ArrowUp",!0)),t.handleInput(new u("ArrowDown",!0)),t.handleInput(new u("ArrowLeft",!0)),t.handleInput(new u("ArrowRight",!0))),this.attackPointerId!==void 0&&this.attackPointerId===h.identifier&&(this.attackPointerId=void 0,this.controls.attack=!1)},this.touchCancelEventListener=s=>{s.preventDefault();for(const h of s.changedTouches)this.directionPointerId!==void 0&&this.directionPointerId===h.identifier&&(this.directionPointerId=void 0,this.controls.horizontal=0,this.controls.vertical=0,t.handleInput(new u("ArrowUp",!0)),t.handleInput(new u("ArrowDown",!0)),t.handleInput(new u("ArrowLeft",!0)),t.handleInput(new u("ArrowRight",!0))),this.attackPointerId!==void 0&&this.attackPointerId===h.identifier&&(this.attackPointerId=void 0,this.controls.attack=!1)}}registerListeners(){window.addEventListener("keydown",this.keyDownEventListener),window.addEventListener("keyup",this.keyUpEventListener),window.addEventListener("touchstart",this.touchStartEventListener),window.addEventListener("touchend",this.touchEndEventListener),window.addEventListener("touchcancel",this.touchCancelEventListener),window.addEventListener("touchmove",t=>{t.preventDefault()})}unregisterListeners(){window.removeEventListener("keydown",this.keyDownEventListener),window.removeEventListener("keyup",this.keyUpEventListener),window.removeEventListener("touchstart",this.touchStartEventListener),window.removeEventListener("touchend",this.touchEndEventListener),window.removeEventListener("touchcancel",this.touchCancelEventListener)}initControlHitBoxes(){this.directionHitBoxes={},this.directionHitBoxes.up=new r(this.directionsPosition.x-o.width,this.directionsPosition.y-a.height,o.width*2,a.height*.6),this.directionHitBoxes.down=new r(this.directionsPosition.x-o.width,this.directionsPosition.y+a.height*.4,o.width*2,a.height*.6),this.directionHitBoxes.left=new r(this.directionsPosition.x-o.width,this.directionsPosition.y-a.height,o.width*.6,a.height*2),this.directionHitBoxes.right=new r(this.directionsPosition.x+o.width*.4,this.directionsPosition.y-a.height,o.width*.6,a.height*2),this.attackHitBox=new r(this.actionsPosition.x-g.width,this.actionsPosition.y-g.height/2,g.width,g.height)}resize(t,e){this.directionsPosition.x=Math.floor(t.width*this.directionsPosition.xPercent/100),this.directionsPosition.y=Math.floor(t.height*this.directionsPosition.yPercent/100),this.actionsPosition.x=Math.floor(t.width*this.actionsPosition.xPercent/100),this.actionsPosition.y=Math.floor(t.height*this.actionsPosition.yPercent/100),this.initControlHitBoxes()}draw(t,e){const i=this.controls.vertical<0?$:_,s=this.controls.vertical>0?et:tt,h=this.controls.horizontal<0?st:it,d=this.controls.horizontal>0?nt:ht,f=this.controls.attack?ot:at;t.drawImage(i,0,0,a.width,a.height,this.directionsPosition.x-a.width/2,this.directionsPosition.y-a.height,a.width,a.height),t.drawImage(s,0,0,a.width,a.height,this.directionsPosition.x-a.width/2,this.directionsPosition.y,a.width,a.height),t.drawImage(h,0,0,o.width,o.height,this.directionsPosition.x-o.width,this.directionsPosition.y-o.height/2,o.width,o.height),t.drawImage(d,0,0,o.width,o.height,this.directionsPosition.x,this.directionsPosition.y-o.height/2,o.width,o.height),t.drawImage(f,0,0,g.width,g.height,this.actionsPosition.x-g.width,this.actionsPosition.y-g.height/2,g.width,g.height),this.debugDraw(t,this.directionHitBoxes.up),this.debugDraw(t,this.directionHitBoxes.right),this.debugDraw(t,this.directionHitBoxes.down),this.debugDraw(t,this.directionHitBoxes.left)}debugDraw(t,e){t.strokeRect(e.x,e.y,e.width,e.height)}update(){}}class lt{constructor(t,e,i,s){this.game=t,this.context=t.context,this.levelDetails=e,this.hero=i,this.goals=s,this.controller=new dt(i,{x:t.size.width*.1,y:t.size.height*.9,xPercent:10,yPercent:90},{x:t.size.width*.9,y:t.size.height*.95,xPercent:95,yPercent:90}),this.controller.registerListeners(),this.backgrounds=[],this.villains=[],this.coins=[],this.powerUps=[],this.targetGoal=s,this.resize(this.game.size,this.game.ratio)}isLevelCompleted(){return this.targetGoal.isAchieved(this.game.score)}start(t){this.targetGoal=this.goals.add(t)}resize(t,e){const i=Math.floor(20*e.xScale);this.context.font=`${i}px Bungee`,this.hero.resize(t,e),this.controller.resize(t,e)}}class ct{constructor(t){this.levelNumber=t}}class ut extends lt{constructor(t,e,i,s){super(t,e,i,s),this.renderGoals=!0,this.renderGoalsListener=()=>{this.renderGoals=!1,window.removeEventListener("keypress",this.renderGoalsListener)},window.addEventListener("keypress",this.renderGoalsListener),this.backgrounds.push(new m("img/background/nature-landscape/layer-1.png",0,t.size)),this.backgrounds.push(new m("img/background/nature-landscape/layer-2.png",-.05,t.size)),this.backgrounds.push(new m("img/background/nature-landscape/layer-3.png",-.1,t.size)),this.backgrounds.push(new m("img/background/nature-landscape/layer-4.png",-.15,t.size)),this.backgrounds.push(new m("img/background/nature-landscape/layer-5.png",-.25,t.size)),this.backgrounds.push(new m("img/background/nature-landscape/layer-6.png",-.25,t.size)),this.backgrounds.push(new m("img/background/nature-landscape/layer-7.png",-.5,t.size));const h=50,d=["bat01","bat02","bat03"];for(let c=1;c<=h;c++){let w=new z(t.size,d[Math.floor(Math.random()*100%d.length)]);w.setPosition(t.size.width*1.1+this.game.size.width*.5*c+(Math.random()-.5)*50,this.game.size.height/2+(Math.random()-.5)*200),this.villains.push(w)}const f=100;for(let c=1;c<=f;c++){let w=new x(this.game.size);w.setPosition(this.game.size.width*1.1+this.game.size.width*.25*c+(Math.random()-.5)*50,w.y),this.coins.push(w)}const B=Math.floor(h/15);for(let c=1;c<=B;c++){let w=new M(this.game.size);w.setPosition(this.villains[c*15-1].x+(Math.random()-.5)*50,this.game.size.height/2),this.powerUps.push(w)}}resize(t,e){super.resize(t,e);for(let i of this.backgrounds)i.resize(t,e);for(let i of this.villains)i.resize(t,e),i.setPosition(i.x,this.game.size.height*.5);for(let i of this.coins)i.resize(t,e);for(let i of this.powerUps)i.resize(t,e)}renderLevelGoals(t,e){this.backgrounds[0].draw(t,e),this.context.save(),this.context.textAlign="center",this.context.fillText(`Level ${this.levelDetails.levelNumber}`,this.game.size.width*.5,this.game.size.height*.3),this.context.fillText(`Collect ${this.goals.coins} coins`,this.game.size.width*.5,this.game.size.height*.4);const i=new x(this.game.size);if(i.setPosition(this.game.size.width*.325,this.game.size.height*.39-36),i.draw(t,0),this.goals.defeatedVillains>0){this.context.fillText(`Defeat ${this.goals.defeatedVillains} villains`,this.game.size.width*.5,this.game.size.height*.5);const s=new z(this.game.size,"bat01");s.setPosition(this.game.size.width*.285,this.game.size.height*.5),s.draw(t,0)}this.context.restore()}draw(t,e){if(this.renderGoals){this.renderLevelGoals(t,e);return}for(let i of this.backgrounds)i.draw(this.context,e);for(let i of this.villains)i.draw(this.context,e);for(let i of this.coins)i.draw(this.context,e);for(let i of this.powerUps)i.draw(this.context,e);this.hero.draw(this.context,e),this.controller.draw(t,e)}update(t){if(!this.renderGoals){if(this.isLevelCompleted()){this.game.levelCompleted(this);return}for(let e of this.backgrounds)e.update(t);for(let e of this.villains)e.update(t);for(let e of this.coins)e.update(t);for(let e of this.powerUps)e.update(t);if(this.hero.update(t),this.context.fillText(`Score: ${this.game.score.points}`,this.game.size.width*.025,this.game.size.height*.1),this.context.fillText(`Coins: ${this.game.score.coins}`,this.game.size.width*.025,this.game.size.height*.15),this.context.fillText(`Villains: ${this.game.score.defeatedVillains}`,this.game.size.width*.025,this.game.size.height*.2),this.context.fillText(`Life: ${this.hero.life}`,this.game.size.width*.025,this.game.size.height*.25),this.context.fillText(`Sound: ${this.game.soundOn?"On":"Off"}`,this.game.size.width*.025,this.game.size.height*.3),!this.hero.isDefeated()){for(let e of this.villains){if(e.defeated||e.disabled)continue;const i=this.hero.getHitBox(),s=e.getHitBox();i.collidesWith(s)&&(this.hero.isAttacking()?(e.tryDefeated(),this.game.score.defeatedVillain(e)):this.hero.tryGetHit())}for(let e of this.coins){if(e.disabled||this.hero.isAttacking())continue;const i=this.hero.getHitBox(),s=e.getHitBox();i.collidesWith(s)&&(e.tryCapture(),this.game.score.addPoints(e.scoreValue),this.game.score.addCoins(1))}for(let e of this.powerUps){if(e.disabled||this.hero.isAttacking())continue;const i=this.hero.getHitBox(),s=e.getHitBox();i.collidesWith(s)&&(e.tryCapture(),this.game.score.addPoints(e.scoreValue),this.hero.increaseLife(e.lifeValue))}}this.hero.gameOver&&this.context.fillText("Game Over.",this.game.size.width*.45,this.game.size.height*.4)}}}class p{constructor(t,e,i){this.coins=t,this.defeatedVillains=e,this.timeInMillis=i}add(t){return new p(this.coins+t.coins,this.defeatedVillains+t.defeatedVillains,this.timeInMillis)}isAchieved(t){return!(this.coins&&t.coins<this.coins||this.defeatedVillains&&t.defeatedVillains<this.defeatedVillains)}}class gt{constructor(){this.points=0,this.coins=0,this.defeatedVillains=0}addPoints(t){this.points+=t,this.points<0&&(this.points=0)}addCoins(t){this.coins+=t,this.coins<0&&(this.coins=0)}defeatedVillain(t){this.points+=t.scoreValue,this.defeatedVillains++}}const I=new l(1180,820,1);class At{constructor(t){this.xScale=t.width/I.width,this.yScale=t.height/I.height}}window.onload=function(){new wt().start()};class wt{constructor(){this.canvas=document.getElementById("canvas"),this.context=this.canvas.getContext("2d"),this.resize(new l(window.innerWidth,window.innerHeight)),this.soundOn=!1,this.currentLevel=void 0,this.score=new gt,this.allGoals=[],this.currentGoalIndex=0,window.addEventListener("resize",t=>{this.resize(new l(t.currentTarget.innerWidth,t.currentTarget.innerHeight))})}resize(t){this.size=t,this.ratio=new At(t),this.canvas.width=t.width,this.canvas.height=t.height,this.canvas.fontFamily="Bungee",this.currentLevel&&this.currentLevel.resize(this.size,this.ratio)}start(){let t=new Audio("sounds/Fun-Background.mp3");t.loop=!0,window.addEventListener("keypress",i=>{i.key==="s"&&(this.soundOn=!this.soundOn,this.soundOn?t.play():t.pause())}),this.hero=new D(this),this.allGoals.push(new p(10)),this.allGoals.push(new p(20,5)),this.allGoals.push(new p(35,10)),this.allGoals.push(new p(50,30)),this.allGoals.push(new p(60,50)),this.currentLevel=this.getCurrentLevel();let e=new Date().getTime();this.gameLoop=(function(){this.context.clearRect(0,0,this.size.width,this.size.height);const i=new Date().getTime(),s=i-e;e=i,this.currentLevel.draw(this.context,s),this.currentLevel.update(s),requestAnimationFrame(this.gameLoop)}).bind(this),this.gameLoop()}getCurrentLevel(){return new ut(this,new ct(this.currentGoalIndex+1),this.hero,this.allGoals[this.currentGoalIndex])}levelCompleted(t){this.currentGoalIndex++,this.currentLevel=this.getCurrentLevel(),this.currentLevel.start(this.score)}}
